--- /usr/share/horde3/lib/Horde/iCalendar/vfreebusy.php.orig    2005-11-22 22:51:25.000000000 +0100
+++ /usr/share/horde3/lib/Horde/iCalendar/vfreebusy.php 2006-02-27 16:24:29.000000000 +0100
@@ -27,16 +27,15 @@
         parent::parsevCalendar($data, 'VFREEBUSY');

         // Do something with all the busy periods.
-        foreach ($this->_attributes as $key => $attribute) {
+        foreach ($this->_attributes as $attribute) {
             if ($attribute['name'] == 'FREEBUSY') {
-                foreach ($attribute['value'] as $value) {
-                    if (array_key_exists('duration', $attribute['value'])) {
-                       $this->addBusyPeriod('BUSY', $value['start'], null, $value['duration']);
-                    } else {
-                       $this->addBusyPeriod('BUSY', $value['start'], $value['end']);
-                    }
+               $value = $attribute['value'];
+
+                if (array_key_exists('duration', $attribute['value'])) {
+                   $this->addBusyPeriod('BUSY', $value['start'], null, $value['duration']);
+                } else {
+                   $this->addBusyPeriod('BUSY', $value['start'], $value['end']);
                 }
-                unset($this->_attributes[$key]);
             }
         }
     }

